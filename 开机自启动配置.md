# 彩票分析系统 - 开机自启动配置指南

## 方法一：使用 Windows 启动文件夹（推荐）

### 步骤：

1. **创建快捷方式**
   - 右键点击 `启动托盘服务.bat`
   - 选择"创建快捷方式"
   - 将快捷方式重命名为"彩票分析系统"

2. **复制到启动文件夹**
   - 按 `Win + R` 打开运行窗口
   - 输入：`shell:startup`
   - 回车打开启动文件夹
   - 将刚才创建的快捷方式复制到该文件夹

3. **验证**
   - 重启电脑
   - 系统托盘应该会自动出现彩票图标

---

## 方法二：使用任务计划程序（高级）

### 步骤：

1. **打开任务计划程序**
   - 按 `Win + R`
   - 输入：`taskschd.msc`
   - 回车

2. **创建基本任务**
   - 点击右侧"创建基本任务"
   - 名称：`彩票分析系统`
   - 描述：`后台托盘服务`
   - 点击"下一步"

3. **设置触发器**
   - 选择"当用户登录时"
   - 点击"下一步"

4. **设置操作**
   - 选择"启动程序"
   - 点击"下一步"

5. **程序设置**
   - 程序或脚本：浏览选择 `pythonw.exe`
     - 通常位置：`C:\Users\你的用户名\AppData\Local\Programs\Python\Python313\pythonw.exe`
     - 或运行 `where pythonw` 查找路径

   - 添加参数：`tray_app.py`

   - 起始于：填写项目完整路径
     - 例如：`C:\Users\Administrator\Desktop\six666`

6. **高级设置**
   - 勾选"使用最高权限运行"（可选）
   - 点击"完成"

7. **验证**
   - 在任务计划程序中找到刚创建的任务
   - 右键点击，选择"运行"测试
   - 重启电脑验证自动启动

---

## 方法三：使用 VBS 脚本（静默启动）

### 步骤：

1. **已为你创建了 VBS 脚本**
   - 文件名：`启动托盘服务.vbs`
   - 该脚本可以完全静默启动，无任何窗口闪烁

2. **创建快捷方式**
   - 右键点击 `启动托盘服务.vbs`
   - 选择"创建快捷方式"

3. **复制到启动文件夹**
   - 按 `Win + R` → 输入 `shell:startup`
   - 将快捷方式复制进去

4. **优点**
   - 完全静默，无窗口闪烁
   - 更加专业的启动方式

---

## 如何停止自启动

### 方法一（启动文件夹）：
- 按 `Win + R` → `shell:startup`
- 删除相关快捷方式

### 方法二（任务计划程序）：
- 按 `Win + R` → `taskschd.msc`
- 找到"彩票分析系统"任务
- 右键 → 禁用 或 删除

---

## 如何退出程序

1. **通过托盘图标**
   - 右键点击系统托盘的彩票图标
   - 选择"退出"

2. **通过任务管理器**
   - 按 `Ctrl + Shift + Esc` 打开任务管理器
   - 找到 `pythonw.exe` 进程
   - 右键 → 结束任务

---

## 故障排查

### 图标没有出现
1. 检查 `logs/tray_app.log` 日志文件
2. 确认依赖已安装：运行 `安装依赖.bat`
3. 手动运行 `python tray_app.py` 查看错误信息

### 服务无法访问
1. 右键托盘图标 → "查看状态"
2. 检查端口是否被占用
3. 右键托盘图标 → "重启服务"

### Python 路径问题
- 运行 `where python` 和 `where pythonw` 查看路径
- 确保 Python 已添加到系统 PATH

---

## 当前配置

- **后端地址**: http://localhost:8000
- **前端地址**: http://localhost:8080
- **日志目录**: `logs/`
- **配置文件**: `config.json`

---

## 使用建议

1. **推荐使用方法一**（启动文件夹），最简单直接
2. **方法三** VBS 脚本适合追求无窗口闪烁的用户
3. **方法二** 任务计划程序适合需要高级配置的用户

设置完成后，每次开机系统都会自动在后台启动服务，你只需要打开浏览器访问即可！
